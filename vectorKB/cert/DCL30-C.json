[
  {
    "id": "DCL30-C_pdf_0",
    "source": "CERT_PDF",
    "cert_rule": "DCL30-C",
    "title": "Declare objects with appropriate storage durations",
    "kind": "description",
    "text": "Every object has a storage duration that determines its lifetime: static, thread, automatic, or allo- cated. According to the C Standard, 6.2.4, paragraph 2 [ISO/IEC 9899:2011], The lifetime of an object is the portion of program execution during which storage is guaranteed to be reserved for it. An object exists, has a constant address, and retains its last-stored value throughout its lifetime. If an object is referred to outside of its lifetime, the behavior is undefined. The value of a pointer becomes indeterminate when the ob- ject it points to reaches the end of its lifetime. Do not attempt to access an object outside of its lifetime. Attempting to do so is undefined behav- ior and can lead to an exploitable vulnerability. (See also undefined behavior 9 in the C Standard, Annex J.) 3.1.1"
  },
  {
    "id": "DCL30-C_samples_c0.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/c0.c",
    "kind": "compliant",
    "text": "// DCL30-C: Compliant Solution (Same Storage Durations)\nvoid this_is_OK(void) {\n  const char c_str[] = \"Everything OK\";\n  const char *p = c_str;\n  /* ... */\n}\n/* p is inaccessible outside the scope of string c_str */\n"
  },
  {
    "id": "DCL30-C_samples_c1.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/c1.c",
    "kind": "compliant",
    "text": "// DCL30-C: Compliant Solution (Differing Storage Durations)\nconst char *p;\nvoid is_this_OK(void) {\n  const char c_str[] = \"Everything OK?\";\n  p = c_str;\n  /* ... */\n  p = NULL;\n}\n"
  },
  {
    "id": "DCL30-C_samples_c2.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/c2.c",
    "kind": "compliant",
    "text": "// DCL30-C: Compliant Solution (Return Values)\n#include <stddef.h>\nvoid init_array(char *array, size_t len) {\n  /* Initialize array */\n  return;\n}\n \nint main(void) {\n  char array[10];\n  init_array(array, sizeof(array) / sizeof(array[0]));\n  /* ... */\n  return 0;\n}\n"
  },
  {
    "id": "DCL30-C_samples_c3.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/c3.c",
    "kind": "compliant",
    "text": "// DCL30-C: Compliant Solution (Output Parameter)\nchar local[10];\n  \nvoid squirrel_away(char **ptr_param) {\n  /* Initialize array */\n  *ptr_param = local;\n}\n \nvoid rodent(void) {\n  char *ptr;\n  squirrel_away(&ptr);\n  /* ptr is valid in this scope */\n}\n"
  },
  {
    "id": "DCL30-C_samples_nc0.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/nc0.c",
    "kind": "noncompliant",
    "text": "// DCL30-C: Noncompliant Code Example (Differing Storage Durations)\n#include <stdio.h>\n  \nconst char *p;\nvoid dont_do_this(void) {\n  const char c_str[] = \"This will change\";\n  p = c_str; /* Dangerous */\n}\n \nvoid innocuous(void) {\n  printf(\"%s\\n\", p);\n}\n \nint main(void) {\n  dont_do_this();\n  innocuous();\n  return 0;\n}\n"
  },
  {
    "id": "DCL30-C_samples_nc1.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/nc1.c",
    "kind": "noncompliant",
    "text": "// DCL30-C: Noncompliant Code Example (Return Values)\nchar *init_array(void) {\n  char array[10];\n  /* Initialize array */\n  return array;\n}\n"
  },
  {
    "id": "DCL30-C_samples_nc2.c",
    "source": "CERT_SAMPLES",
    "cert_rule": "DCL30-C",
    "file_path": "rules/dcl/30/nc2.c",
    "kind": "noncompliant",
    "text": "// DCL30-C: Noncompliant Code Example (Output Parameter)\nvoid squirrel_away(char **ptr_param) {\n  char local[10];\n  /* Initialize array */\n  *ptr_param = local;\n}\n \nvoid rodent(void) {\n  char *ptr;\n  squirrel_away(&ptr);\n  /* ptr is live but invalid here */\n}\n"
  }
]